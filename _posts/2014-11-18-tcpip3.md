---
layout: post
title: "tcp/ip详解学习笔记--IP(网络层)"
description: ""
category:
tags: [tcp/ip]
---
{% include JB/setup %}     
> 请尊重原创，转载请注明

1. ####ip协议的特点
	* 不可靠：不保证ip数据报能成功到达目的地，如果遇上哪个路由器有问题，ip有一个简单的错误处理方法，就是把这个数据报丢弃，然后通过ICMP消息报告给发送源。任何要求的可靠性都要求上层协议来实现（如TCP）
	* 无连接：意思是ip并不维护后续数据报的状态信息，也就是说每个数据报是独立的，互相没有关系。
2. ####协议格式
<img src="https://raw.githubusercontent.com/arkulo56/arkulo56.github.com/master/images/tcpip/1.png" width="650" />
	1）目前协议版本号是4，也就是ipv4     
	2）首部长度指一共有多少“行”（32bit），由于它是个4bit长度，因此`ip首部最长是60字节`，普通ip数据包长度为5         
	3）服务类型字段包括3部分：3bit的优先权（弃用）、4bitTOS字段、1bit未用（必须置0），其中4bit的TOS分别代表`最小时延`,`最大吞吐量`,`最高可用性`和`最小费用`，不同的应用关注的特性不同，例如FTP关注的就是最大吞吐量（下面的图罗列了许多应用的ip特性）    
	4）数据总长度是16bit`字节数`,也就是说ip数据报总长度最多可以是35535个字节。长度超了需要分片（主机要求接受不超过576字节数据报），长度小了还得还需要填充数据（以太网规定的数据部分最小是46字节，如果不够需要填充）    
	5）标识字段唯一的标识主机发送的每一份数据报，没发送一次报文，它的值加1    
	6）TTL生存时间记录的是数据报最多可以经过多少个路由器，每经过一个路由器，该值减1，通常被设置为32或64    
	7）8位协议字段表示上层传输数据的协议是什么    
	8）16位首部校验和就是根据首部每16bit的值反码求和，然后将值保存在这个字段中，如果接受方接到的数据计算的值与该字段保存的值不同，则认为数据在传输过程中存在误差，遂丢弃！     
	9）源ip地址和目标ip地址就不再赘述，都是32bit     
该图是4bitTOS常见应用：
<img src="https://raw.githubusercontent.com/arkulo56/arkulo56.github.com/master/images/tcpip/2.png" width="650" />
3. ####
51883333